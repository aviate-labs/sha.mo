import Blob "mo:base/Blob";
import Hex "mo:encoding/Hex";
import Text "mo:base/Text";

import Debug "mo:base/Debug";

import SHA256 "../src/SHA256";

let sum256 = SHA256.sum256(Blob.toArray(Text.encodeUtf8("hello world\n")));
assert(Hex.encode(sum256) == "A948904F2F0F479B8F8197694B30184B0D2ED1C1CD2A1EC0FB85D299A192A447");

let h = SHA256.Hash(false);
h.write(Blob.toArray(Text.encodeUtf8("hello world\n")));
assert(Hex.encode(sum256) == Hex.encode(h.sum([])));

for (v in [
    ("", "E3B0C44298FC1C149AFBF4C8996FB92427AE41E4649B934CA495991B7852B855"),
    ("a", "CA978112CA1BBDCAFAC231B39A23DC4DA786EFF8147C4E72B9807785AFEE48BB"),
    ("ab", "FB8E20FC2E4C3F248C60C39BD652F3C1347298BB977B8B4D5903B85055620603"),
    ("abc", "BA7816BF8F01CFEA414140DE5DAE2223B00361A396177A9CB410FF61F20015AD"),
    ("abcd", "88D4266FD4E6338D13B845FCF289579D209C897823B9217DA3E161936F031589"),
    ("abcde", "36BBE50ED96841D10443BCB670D6554F0A34B761BE67EC9C4A8AD2C0C44CA42C"),
    ("abcdef", "BEF57EC7F53A6D40BEB640A780A639C83BC29AC8A9816F1FC6C5C6DCD93C4721"),
    ("abcdefg", "7D1A54127B222502F5B79B5FB0803061152A44F92B37E23C6527BAF665D4DA9A"),
    ("abcdefgh", "9C56CC51B374C3BA189210D5B6D4BF57790D351C96C47C02190ECF1E430635AB"),
    ("abcdefghi", "19CC02F26DF43CC571BC9ED7B0C4D29224A3EC229529221725EF76D021C8326F"),
    ("abcdefghij", "72399361DA6A7754FEC986DCA5B7CBAF1C810A28DED4ABAF56B2106D06CB78B0"),
].vals()) {
    assert(Hex.encode(SHA256.sum256(Blob.toArray(Text.encodeUtf8(v.0)))) == v.1);
};

let sum224 = SHA256.sum224(Blob.toArray(Text.encodeUtf8("hello world\n")));
assert(Hex.encode(sum224) == "95041DD60AB08C0BF5636D50BE85FE9790300F39EB84602858A9B430");

for (v in [
    ("", "D14A028C2A3A2BC9476102BB288234C415A2B01F828EA62AC5B3E42F"),
    ("a", "ABD37534C7D9A2EFB9465DE931CD7055FFDB8879563AE98078D6D6D5"),
    ("ab", "DB3CDA86D4429A1D39C148989566B38F7BDA0156296BD364BA2F878B"),
    ("abc", "23097D223405D8228642A477BDA255B32AADBCE4BDA0B3F7E36C9DA7"),
    ("abcd", "A76654D8E3550E9A2D67A0EEB6C67B220E5885EDDD3FDE135806E601"),
    ("abcde", "BDD03D560993E675516BA5A50638B6531AC2AC3D5847C61916CFCED6"),
    ("abcdef", "7043631CB415556A275A4EBECB802C74EE9F6153908E1792A90B6A98"),
    ("abcdefg", "D1884E711701AD81ABE0C77A3B0EA12E19BA9AF64077286C72FC602D"),
    ("abcdefgh", "17EB7D40F0356F8598E89EAFAD5F6C759B1F822975D9C9B737C8A517"),
    ("abcdefghi", "AEB35915346C584DB820D2DE7AF3929FFAFEF9222A9BCB26516C7334"),
    ("abcdefghij", "D35E1E5AF29DDB0D7E154357DF4AD9842AFEE527C689EE547F753188"),
].vals()) {
    assert(Hex.encode(SHA256.sum224(Blob.toArray(Text.encodeUtf8(v.0)))) == v.1);
};
